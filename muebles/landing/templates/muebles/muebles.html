{% extends 'index.html' %}


{% block pages %}
{% if mueble %}
<li onclick='location.href="/";'>Catálogo</a></li>
{% endif %}
<li onclick='location.href="/add";'>Añadir mueble</a></li>
<li onclick='location.href="/perfil";'>Perfil</a></li>
{% endblock %}

{% block content %}
{% if listaMuebles %}
<div class="muebles-table">
	{% for mueble in listaMuebles %}
	<div onclick='location.href="/{{mueble.id}}/post";' class="mueble-container">
		<h2>{{ mueble.nombre }}</h2>
		<br>
		{% load static %}
		<img src="{{ mueble.main_image.url }}" alt="Imagen errónea">
		<h3>Ubicación:</h3>
		<p>{{ mueble.ubiInicial }}</p>
	</div>
	{% endfor %}
</div>

{% elif not mueble %}
<p>No muebles are available</p>
{% endif %}

{% if mueble %}
<div class="info-mueble">
	<h1 class="nom">{{ mueble.nombre }}</h1>
	{% for image in images %}
	<img src="{{ image.url }}" class="foto">
	{% endfor %}
	<i class="arrow right"></i>
	<i class="arrow left"></i>
	<t1>Descipción:</t1>
	<p class="desc">{{ mueble.descripcion }}</p>
	<t2>Ubicación:</t2>
	<p class="ubi"> {{ mueble.ubiInicial }}</p>
	<t3>Ofertante:</t3>
	<p class="ofer"> {{ ofertante.nombre }} {{ ofertante.apellidos }}</p>
	<t4>Organizacion:</t4>
	<p class="org"> {{ ofertante.organizacion }}</p>
</div>
{% endif %}

<script>
	const images = document.querySelectorAll('.info-mueble img');
	let currentIndex = 0;

	function changeImage(value) {
		images[currentIndex].style.opacity = '0';
		images[currentIndex].style.zIndex = '-1';
		currentIndex = (currentIndex + value) 
		if(currentIndex < 0){
			currentIndex = images.length - 1;
		}
		currentIndex %= images.length;

		images[currentIndex].style.opacity = '1';
		images[currentIndex].style.zIndex = '1';
	}

	images[currentIndex].style.opacity = '1'; // show the first image initially
	images[currentIndex].style.zIndex = '1';

	const leftArrow = document.querySelector('.left');
	const rightArrow = document.querySelector('.right');

	leftArrow.addEventListener('click', () => {
		changeImage(-1);
	});
	rightArrow.addEventListener('click', () => {
		changeImage(1);
	});

</script>
{% endblock %}

{% block logged %}
<li class="last" onclick='location.href="/logout";'>Log out</a></li>
{% endblock %}
